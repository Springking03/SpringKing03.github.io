<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ch√∫c m·ª´ng sinh nh·∫≠t ‚Äì Tr·∫ßn Vi·ªát Anh</title>

<!-- Preload video ƒë·ªÉ v√†o l√† ch∆°i m∆∞·ª£t -->
<link rel="preload" as="video" href="video.mp4" type="video/mp4">

<style>
  :root{ --bg1:#0f0c29; --bg2:#302b63; --bg3:#24243e; --accent:#ff5fa2; --accent2:#ffd1dc; }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    background: radial-gradient(1200px 800px at 50% 20%, rgba(255,255,255,0.06), transparent 60%),
                linear-gradient(135deg, var(--bg1), var(--bg2), var(--bg3));
    color:#fff; overflow:hidden;
  }

  .stage{ position:fixed; inset:0; display:grid; place-items:center; padding:24px; }
  .card{
    max-width:min(900px, 92vw); text-align:center; padding:clamp(16px, 5vw, 40px);
    border-radius:24px; background:rgba(255,255,255,0.06); backdrop-filter: blur(8px);
    box-shadow: 0 10px 40px rgba(0,0,0,0.35), inset 0 0 0 1px rgba(255,255,255,0.08);
  }
  .title{
    margin:0 0 18px; font-weight:800; line-height:1.2; letter-spacing:.5px;
    font-size: clamp(22px, 5vw, 42px);
    background: linear-gradient(90deg, #fff, var(--accent), var(--accent2), #fff);
    -webkit-background-clip:text; background-clip:text; color:transparent;
    filter: drop-shadow(0 2px 8px rgba(255,95,162,.25));
  }
  .btn{
    display:inline-block; border:0; border-radius:14px; padding:14px 22px;
    font-size: clamp(14px, 3.4vw, 18px); font-weight:700; color:#1a0820;
    background: linear-gradient(90deg, #ffd1dc, #ff9ec4, #ffd1dc);
    cursor:pointer; box-shadow: 0 10px 24px rgba(255,158,196,.35);
  }
  .fade-out{ animation: fadeOut .5s ease forwards } @keyframes fadeOut{ to{opacity:0; transform:scale(.98)} }

  .video-wrap{ position:fixed; inset:0; display:none; background:#000; }
  .video-wrap.show{ display:block }
  video{ width:100vw; height:100vh; object-fit:cover; background:#000; }

  .end-screen{
    position:fixed; inset:0; display:none; place-items:center; background:#000; color:#fff;
    text-align:center; padding:24px;
  }
  .end-screen.show{ display:grid }
</style>
</head>
<body>

<!-- M√†n h√¨nh intro -->
<div class="stage" id="intro">
  <div class="card">
    <h1 class="title">ch√∫c m·ª´ng sinh nh·∫≠t b·∫°n c·ªßa t√¥i Tr·∫ßn Vi·ªát Anh</h1>
    <button class="btn" id="startBtn" aria-label="Xem ngay">üé¨ Xem ngay</button>
  </div>
</div>

<!-- Ph√°t video to√†n m√†n h√¨nh (kh√¥ng controls, kh√¥ng tua) -->
<div class="video-wrap" id="videoWrap" role="region" aria-label="Video sinh nh·∫≠t">
  <!-- L∆∞u √Ω: KH√îNG ƒë·ªÉ controls; kh√≥a c√°c t√≠nh nƒÉng kh√°c b·∫±ng attributes -->
  <video id="vid"
         src="Chucmung_VietAnh_SinhNhat.mp4"
         preload="auto"
         playsinline
         webkit-playsinline
         controlslist="nodownload noplaybackrate noremoteplayback nofullscreen"
         disablepictureinpicture
         oncontextmenu="return false;">
  </video>
</div>

<!-- M√†n h√¨nh k·∫øt th√∫c (kh√¥ng cho replay) -->
<div class="end-screen" id="endScreen">
  <div>
    <h2>üíù Ch√∫c m·ª´ng sinh nh·∫≠t!</h2>
    <p>Hy v·ªçng b·∫°n ƒë√£ c√≥ m·ªôt kho·∫£nh kh·∫Øc th·∫≠t ƒë·∫πp.</p>
  </div>
</div>

<script>
  const intro   = document.getElementById('intro');
  const startBtn= document.getElementById('startBtn');
  const wrap    = document.getElementById('videoWrap');
  const video   = document.getElementById('vid');
  const endScr  = document.getElementById('endScreen');

  // --- NgƒÉn tua / thao t√°c kh√¥ng mong mu·ªën ---
  let lastSafeTime = 0;
  let ended = false;

  // Kh√¥ng hi·ªán controls
  video.controls = false;

  // NgƒÉn click/tap pause video
  video.addEventListener('click', e => e.preventDefault());
  video.addEventListener('touchstart', e => e.preventDefault());

  // Ch·∫∑n ph√≠m tua/space
  document.addEventListener('keydown', e => {
    const block = ['ArrowLeft','ArrowRight','ArrowUp','ArrowDown',' '];
    if (block.includes(e.key)) e.preventDefault();
  });

  // Kh√≥a seeking: n·∫øu user (ho·∫∑c h·ªá th·ªëng) c·ªë nh·∫£y th·ªùi gian, ƒë∆∞a v·ªÅ lastSafeTime
  video.addEventListener('seeking', () => {
    const t = video.currentTime || 0;
    if (Math.abs(t - lastSafeTime) > 0.3) {
      video.currentTime = lastSafeTime;
    }
  });

  video.addEventListener('timeupdate', () => {
    // c·∫≠p nh·∫≠t m·ªëc an to√†n li√™n t·ª•c, ch·ªâ tƒÉng d·∫ßn
    if (video.currentTime > lastSafeTime) lastSafeTime = video.currentTime;
  });

  // Kh√¥ng cho pause (tr·ª´ khi ƒë√£ k·∫øt th√∫c)
  video.addEventListener('pause', () => {
    if (!ended) {
      // Trong 1 s·ªë tr√¨nh duy·ªát t·∫°m d·ª´ng khi gi√°n ƒëo·∫°n m·∫°ng -> auto resume
      video.play().catch(()=>{ /* ignore */ });
    }
  });

  // K·∫øt th√∫c: ·∫©n video, hi·ªán m√†n h√¨nh l·ªùi ch√∫c; kh√¥ng cho replay
  video.addEventListener('ended', () => {
    ended = true;
    wrap.classList.remove('show');
    endScr.classList.add('show');

    // Ng·∫Øt ngu·ªìn ƒë·ªÉ kh√¥ng th·ªÉ play l·∫°i
    try { video.srcObject = null; } catch(e){}
    video.removeAttribute('src');
    video.load();
  });

  // --- ‚ÄúXem ngay‚Äù: ph√°t t·ª©c th√¨, kh√¥ng th·∫•y load ---
  async function startPlayback(){
    // ·∫®n intro
    intro.classList.add('fade-out');
    await new Promise(r=>setTimeout(r, 480));
    intro.style.display = 'none';

    // Hi·ªán video
    wrap.classList.add('show');

    // Ph√°t v·ªõi √¢m thanh sau thao t√°c ng∆∞·ªùi d√πng
    video.muted = false;

    // N·∫øu ƒë√£ preload xong, play s·∫Ω g·∫ßn nh∆∞ l·∫≠p t·ª©c
    try {
      await video.play();
    } catch (err) {
      // fallback n·∫øu tr√¨nh duy·ªát c√≤n ch·∫∑n: th·ª≠ b·∫≠t muted r·ªìi ph√°t (√≠t khi c·∫ßn v√¨ ƒë√£ c√≥ user gesture)
      try { video.muted = true; await video.play(); } catch(e){}
    }
  }

  startBtn.addEventListener('click', startPlayback);

  // --- Prebuffer im l·∫∑ng tr∆∞·ªõc (tƒÉng kh·∫£ nƒÉng "b·∫•m l√† ch·∫°y ngay") ---
  // Nhi·ªÅu tr√¨nh duy·ªát cho ph√©p autoplay n·∫øu muted -> ta l√†m n√≥ng buffer.
  (async function warmUp(){
    try {
      video.muted = true;
      await video.play();
      // D·ª´ng ngay ƒë·ªÉ kh√¥ng l·ªô √¢m/khung
      await new Promise(r=>setTimeout(r, 100));
      video.pause();
      video.currentTime = 0;
      lastSafeTime = 0;
      video.muted = false;
    } catch(e){
      // N·∫øu kh√¥ng cho autoplay muted, v·∫´n ·ªïn: ƒë√£ preload="auto"
    }
  })();

  // Ch·∫∑n menu chu·ªôt ph·∫£i & gi·ªØ l√¢u ƒë·ªÉ h·∫°n ch·∫ø t·∫£i xu·ªëng
  window.addEventListener('contextmenu', e => e.preventDefault());
</script>
</body>
</html>
